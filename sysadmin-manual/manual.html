<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Niord System User Manual for Sysadmins</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Niord System User Manual for Sysadmins</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#system-administrators-manual">2. System Administrators Manual</a></li>
<li><a href="#sysadmin-page">3. Sysadmin Page</a></li>
<li><a href="#message-series">4. Message Series</a></li>
<li><a href="#domains">5. Domains</a></li>
<li><a href="#promulgation-types">6. Promulgation Types</a></li>
<li><a href="#firing-schedules">7. Firing Schedules</a></li>
<li><a href="#dictionaries">8. Dictionaries</a></li>
<li><a href="#parameter-types">9. Parameter Types</a></li>
<li><a href="#script-resources">10. Script Resources</a></li>
<li><a href="#categories">11. Categories</a></li>
<li><a href="#print-reports">12. Print Reports</a></li>
<li><a href="#keycloak-integration">13. Keycloak Integration</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a><a class="link" href="#introduction">1. Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Niord (Nautical Information Directory) is a system for producing and publishing
Navigational Warnings (<em>NW</em>) and Notices to Mariners T&amp;P (<em>NM</em>).</p>
</div>
<div class="paragraph">
<p>It was originally developed as part of the <a href="http://efficiensea2.org">EfficienSea2</a> EU project
and subsequently implemented as a production system for the
<a href="http://www.dma.dk/">Danish Maritime Authority</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/EfficienSea2.png" alt="EfficienSea2" width="200">
</div>
</div>
<div class="paragraph">
<p>Some of the main features of Niord area:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Niord provides an advanced and highly customizable production system for NW and NM T&amp;P.</p>
</li>
<li>
<p>It includes a plug-in architecture for NW and NM message promulgation via e.g. mailing lists
and Twitter.</p>
</li>
<li>
<p>Niord also integrates with the <a href="http://maritimecloud.net">Maritime Cloud</a> by defining a
Maritime Cloud Service Specification and making NW &amp; NM messages accessible via a
<a href="../public-api/api.html">Public REST API</a></p>
</li>
<li>
<p>The <a href="../public-model/model.html">combined NW &amp; NM message model</a> adopted by Niord has
been devised to make data future-compatible with the upcoming IHO S-124 specification.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="system-administrators-manual"><a class="anchor" href="#system-administrators-manual"></a><a class="link" href="#system-administrators-manual">2. System Administrators Manual</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A user in Niord always works in the context of a <em>current domain</em>.
Domains are used to separate NW &amp; NM messages into more manageable lists -
you could e.g. have a domain for NW messages, a domain for NM messages, a domain
for firing exercises (also NWs), or indeed domains for separate regions with
separate time-zones, etc.</p>
</div>
<div class="paragraph">
<p>A user has separate roles in each domain. The available roles are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>User</em>: The <em>user</em> role can be assigned to e.g. case officers that should have access
to see, proof-read and comment on un-published NW and NM messages.</p>
</li>
<li>
<p><em>Editor</em>: Editors compose and manage the life cycle of an NW or NM message.</p>
</li>
<li>
<p><em>Admin</em>: An administrator of a domain will have additional access to e.g. manage the base data
(sea charts, publications, etc.) of the Niord system.</p>
</li>
<li>
<p><em>Sysadmin</em>: A very special role that should be held only by the person(s) actually setting
up and managing the Niord system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The roles listed above are hierarchical in the sense that a <em>sysadmin</em> can do anything an <em>admin</em>
can do, who in turn can do anything an <em>editor</em> can do, and so forth.</p>
</div>
<div class="paragraph">
<p>This document serves as a user manual for <em>system administrators</em> of a domain.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Please use a newish Chrome, Safari or Firefox browser when using Niord.
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="sysadmin-page"><a class="anchor" href="#sysadmin-page"></a><a class="link" href="#sysadmin-page">3. Sysadmin Page</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Sysadmin</em> page of Niord only become available if you log in as a system administrator.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/SysadminPage.png" alt="Sysadmin" width="800">
</div>
</div>
<div class="paragraph">
<p>The <em>Sysadmin</em> page allows system administrators to manage and configure the Niord system.</p>
</div>
<div class="paragraph">
<p>In general a user that is system administrator in one domain should be system administrator
in all domains, since all the setup and configuration they can manage on the Sysadmin pages
applies to all domains.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="message-series"><a class="anchor" href="#message-series"></a><a class="link" href="#message-series">4. Message Series</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Message Series</em> page allows a system administrator to manage the list of message series used
throughout Niord.
A message series define the types of messages that can be assigned to the message. It also defines how
messages are numbered and the format of their IDs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MessageSeriesPage.png" alt="Message Series" width="600">
</div>
</div>
<div class="paragraph">
<p>The sysadmin may filter the list of message series by typing a term into the <em>Filter</em> input field above the
message series list. The term is matched against the ID of the message series.</p>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-message-series"><a class="anchor" href="#adding-or-editing-a-message-series"></a><a class="link" href="#adding-or-editing-a-message-series">4.1. Adding or Editing a Message Series</a></h3>
<div class="paragraph">
<p>The sysadmin can add a new message series by clicking the "New Message Series" button, or edit an existing
message series by clicking the pencil symbol next to the series.</p>
</div>
<div class="paragraph">
<p>This will open the <em>Message Series Edit Page</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/MessageSeriesEditPage.png" alt="Message Series Editor Page" width="600">
</div>
</div>
<div class="paragraph">
<p>The message series attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Series Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Series ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique ID for the message series. Should be globally unique.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Main Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The main type, i.e. <em>Navigational Warnings</em> or <em>Notices to Mariners</em>, of the messages assigned to the
  message series.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optionally, the sysadmin may specify the specific types (sub-types of the main type) of the messages
  assigned to the message series.
  If the current main type is <em>Navigational Warnings</em>, the possible types include <em>Local</em>, <em>Coastal</em>,
  <em>Subarea</em> and <em>Navarea</em>. If the main type is <em>Notices to Mariners</em>, the possible types include
  <em>Preliminary</em>, <em>Temporary</em>, <em>Permanent</em> and <em>Miscellaneous</em>.
  If none of the types have been selected, all types are valid for the given messages series.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number Sequence Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Number Sequence Type</em> defines how numbers get assigned (or not) to a message when the message
  is published.
  If the type is <em>Yearly</em>, the first message published every year will be assigned the number "1",
  and subsequent message will be numbered consecutively from that.
  If the type is <em>Continuous</em>, the first message published will be assigned the number "1",
  and subsequent message will be numbered consecutively from that.
  If the type is <em>Manual</em>, the editor will get to assign a number manually to a message in the message
  editor. Please refer to the <a href="http://docs.niord.org/editor-manual/manual.html#id-editor-field">Editor Guide</a>.
  If the type is <em>None</em>, no number will be assigned to the messages belonging to this message series.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short Format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Short Format</em> attribute defines the format of the <em>short ID</em> that gets assigned to a message
  upon publication (except if the <em>Number Sequence Type</em> is <em>None</em>).
  The format will typically contain <em>replacement tokens</em> that gets substituted with real values.
  Valid <em>replacement tokens</em> can be inserted into the field via the <em>insert</em> menu, and include tokens
  such as "${number}", "${number-3-digits}", "${year}", "${year-2-digits}", etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Next Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Next number</em> field allows the sysadmin to manually specify the next number to assign to a
  message upon publication. This can be used for all message series with a <em>Number Sequence Type</em> of
  <em>Yearly</em> or <em>Continuous</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional Editor Fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">As described in the <a href="http://docs.niord.org/editor-manual/manual.html#editor">Editors Manual</a>,
  the set of <em>editor fields</em> used by default when editing a message depends on e.g. the main
  type of the message, the category, etc.
  It is also possible to enable non-standard editor fields per message series using the
  <em>Additional Editor Field</em>. As an example, if a message series is used exclusively for firing
  exercise navigational warnings, the sysadmin could enable the "Signals" editor field for that
  message series.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAVTEX Preamble</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>NAVTEX Preamble</em> field is only enabled for Navigational Warnings-related message series.
  It allows for the specification of a standardized NAVTEX preamble to be used for NAVTEX
  promulgations associated with the message. Please refer to the
  <a href="http://docs.niord.org/editor-manual/manual.html#promulgation-editor-field">Editors Guide</a> about
  promulgations.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="deleting-a-message-series"><a class="anchor" href="#deleting-a-message-series"></a><a class="link" href="#deleting-a-message-series">4.2. Deleting a Message Series</a></h3>
<div class="paragraph">
<p>A message series can be deleted by clicking the trash icon next to them.
However, this only works if the message series being deleted has never been assigned to a message.</p>
</div>
<div class="paragraph">
<p>If a message series has indeed been assigned to a message, the sysadmin should instead remove
the message series from the relevant domain.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="domains"><a class="anchor" href="#domains"></a><a class="link" href="#domains">5. Domains</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Domains</em> page allows a system administrator to manage the list of domains in Niord.</p>
</div>
<div class="paragraph">
<p>As described in the <a href="#system-administrators-manual">System Administrators Manual</a> section, a Niord user always works in the context
of a <em>current domain</em>.
Domains are used to separate NW &amp; NM messages into more manageable lists -
such as a specific domain for NW messages, a domain for NM messages, a domain
for firing exercises (also NWs), or indeed domains for separate regions with
separate time-zones, etc.</p>
</div>
<div class="paragraph">
<p>Domains also plays a central role in <a href="#keycloak-integration">Keycloak Integration</a>. Each domain is created as an
application client in Keycloak.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DomainsPage.png" alt="Domains" width="600">
</div>
</div>
<div class="paragraph">
<p>The sysadmin may filter the list of domains by typing a term into the <em>Filter</em> input field above the
domain list. The term is matched against the ID and name of the domains.</p>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-domain"><a class="anchor" href="#adding-or-editing-a-domain"></a><a class="link" href="#adding-or-editing-a-domain">5.1. Adding or Editing a Domain</a></h3>
<div class="paragraph">
<p>The sysadmin can add a new domain by clicking the "New domain" button, or edit an existing
domain by clicking the pencil symbol next to the domain.</p>
</div>
<div class="paragraph">
<p>This will open the <em>Domain Edit Page</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DomainsEditPage.png" alt="Message Series Editor Page" width="400">
</div>
</div>
<div class="paragraph">
<p>The domains attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Domain Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique ID for the domain. The ID is also used as an application client in Keycloak.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only active domains is available in the domain selector in the main menu of Niord.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort Order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The domain sort order. Controls the order of the domains in the domain menu.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keycloak Status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the corresponding Keycloak client does not exist in Keycloak, there will be a button to create
  it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The human readable name of the domain.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time Zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-zone of the domain. The domain time zone will be used at various placed where the
  editor specifies dates, such as the publication dates of a message.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map Center</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optionally, a map center and zoom level can be specified. This will be used whenever a map is opened
  with empty contents, such as when opening the
  <a href="http://docs.niord.org/editor-manual/manual.html#position-editor">Position Editor</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Sort Order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default sort order of messages in the domain. The sort order may be either by message area, ID or
  event dates, in ascending or descending order.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTML Color</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If an HTML color is defined for the message, this color will be displayed in the main menu of Niord
  when the domain is the currently selected domain.
  Any valid HTML color code can be used, such as "red", "#ff0000", etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Areas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Areas</em> field can be used to restrict the areas that may be assigned to messages of that domain.
  If e.g. "Denmark" is selected, then only "Denmark" or any of the sub-areas of "Denmark" can be
  assigned to a message of that domain.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Categories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Categories</em> field can be used to restrict the categories that may be assigned to messages of that domain.
  If e.g. "Firing Exercises" is selected, then only "Firing Exercises" or any of the sub-categories of
  "Firing Exercises" can be assigned to a message of that domain.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Series</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Message Series</em> field must define the valid message series to use in the domain.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Publish</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the <em>Publish</em> flag is checked, then the messages of the domain is included by default, when using
  the public Niord REST API to fetch messages. In effect, this means that third party clients will
  receive messages of the domain by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AtoNs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the <em>AtoNs</em> flag is checked, then the "AtoN" domain will be turned on when the domain is the
  currently selected domain.
  The AtoN module is a prototype module, that integrates an AtoN registry with Niord.
  Since it is not complete, it is not yet documented, and not turned on by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Templates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the <em>Templates</em> flag is checked, then the message template mechanism described in the
  <a href="http://docs.niord.org/editor-manual/manual.html#message-template-execution">Message Template Execution</a>
  chapter will be enabled.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="deleting-a-domain"><a class="anchor" href="#deleting-a-domain"></a><a class="link" href="#deleting-a-domain">5.2. Deleting a Domain</a></h3>
<div class="paragraph">
<p>A domain can be deleted by clicking the trash icon next to them.
However, this only works if there is not related data associated with the domain.</p>
</div>
<div class="paragraph">
<p>Instead the system administrator can choose to in-activate the domain.</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-and-exporting-domains"><a class="anchor" href="#importing-and-exporting-domains"></a><a class="link" href="#importing-and-exporting-domains">5.3. Importing and Exporting Domains</a></h3>
<div class="paragraph">
<p>The system administrator can export and import domains from the action menu.</p>
</div>
<div class="paragraph">
<p>The export/import file format is based on a JSON representation of the
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/domain/vo/DomainVo.java">DomainVo</a>
class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">domainId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">niord-nw</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">active</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">sortOrder</span><span class="delimiter">&quot;</span></span>: <span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NW</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">timeZone</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Europe/Copenhagen</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">messageSeries</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">seriesId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">dma-nw</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">mainType</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NW</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">shortFormat</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NW-${number-3-digits}-${year-2-digits}</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">navtexFormat</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${publish-date}</span><span class="char">\n</span><span class="content">DANISH NAV WARN ${number-year-id}</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">numberSequenceType</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">YEARLY</span><span class="delimiter">&quot;</span></span>
      },
      {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">seriesId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">dma-nw-local</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">mainType</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NW</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">numberSequenceType</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NONE</span><span class="delimiter">&quot;</span></span>
      }
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">publish</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">templates</span><span class="delimiter">&quot;</span></span>:<span class="value">true</span>
  },
  <span class="error">.</span><span class="error">.</span><span class="error">.</span>
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importing a domain JSON file will trigger the <em>domain-import</em> batch job.
Batch jobs can be monitored and managed by system administrators.</p>
</div>
<div class="paragraph">
<p>As an alternative to manually uploading a domain import JSON file on the <em>Domains</em> sysadmin page,
the file can be copied to the <em>$NIORD_HOME/batch-jobs/domain-import/in</em> folder.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="promulgation-types"><a class="anchor" href="#promulgation-types"></a><a class="link" href="#promulgation-types">6. Promulgation Types</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Promulgation Types</em> page allows a system administrator to manage the list of promulgation types
in Niord.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PromulgationTypesPage.png" alt="Promulgation Types" width="600">
</div>
</div>
<div class="paragraph">
<p>For Navigational Warnings in particular, there may be a need to promulgate specialized versions of
a message to external channels.
Niord has a plug-in architecture for adding new promulgation types. By default, it supports
distributing <em>NAVTEX</em> versions of navigational warnings via mailing lists, and support for posting
messages at Twitter upon publication.</p>
</div>
<div class="paragraph">
<p>Furthermore, the Danish version of Niord supports generating an <em>Audio</em> promulgation for
navigational warnings. This will promulgate a verbose textual version of the messages,
suitable to be read up on radio by non-maritime personal, to a mailing list.</p>
</div>
<div class="paragraph">
<p>The integration of promulgation types in the message editor is detailed in the
<a href="http://docs.niord.org/editor-manual/manual.html#promulgation-editor-field">Promulgation Editor Field</a>
chapter of the Editors Manual.</p>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-promulgation-type"><a class="anchor" href="#adding-or-editing-a-promulgation-type"></a><a class="link" href="#adding-or-editing-a-promulgation-type">6.1. Adding or Editing a Promulgation Type</a></h3>
<div class="paragraph">
<p>The sysadmin can add a new instance of a promulgation type by clicking the "Add Promulgation Type" button,
which will allow the sysadmin to select which promulgation type to add:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PromulgationTypesAddBtn.png" alt="Promulgation Types Add Button" width="120">
</div>
</div>
<div class="paragraph">
<p>Similarly, an existing promulgation type can be edited by clicking the pencil symbol next to the
promulgation type.</p>
</div>
<div class="paragraph">
<p>Adding or editing a promulgation type will open the <em>Promulgation Type Edit Page</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PromulgationTypeEditPage.png" alt="Promulgation Type Editor Page" width="600">
</div>
</div>
<div class="paragraph">
<p>All editable attributes, except the bottom-most one, are common to all promulgation types:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Promulgation Type Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only active promulgation types are used when creating a new message.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Promulgate by Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use this checkbox to flag if the promulgation type should be turned on by default for qualifying
  messages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The unique ID of the promulgation type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the promulgation type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Priority</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The sort order of the promulgation type in the message editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some promulgation types may be tied to one of the message model languages. For instance, the
  <em>NAVTEX</em> promulgation type should always be tied to English.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The list of domains for which the promulgation type will be included in the message editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restrict Types</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Depending on the <em>Domains</em> selection above, the messages that will be assigned promulgations
  of the promulgation type can be either <em>NW</em> (navigational warnings) or <em>NM</em> (notices to mariners),
  or both. The <em>Restrict Types</em> field will allow the sysadmin to restrict the promulgation type
  to a selection of <em>NW</em> or <em>NM</em> sub-types.
  As an example, <em>NAVTEX</em> should be associated with <em>Coastal Warnings</em>, not <em>Local Warnings</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script Resource Paths</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optionally, the sysadmin can specify one or more script resources that will be enacted when
  an editor chooses to generate promulgations by executing message templates.
  As an example, the <em>NAVTEX</em> promulgation type runs a Freemarker script that adds the
  currently selected message area as a preamble NAVTEX line.
  Script Resources is an advanced topic detailed in the <a href="#script-resources">Script Resources</a> chapter.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="promulgation-type-specific-editor-fields"><a class="anchor" href="#promulgation-type-specific-editor-fields"></a><a class="link" href="#promulgation-type-specific-editor-fields">6.1.1. Promulgation Type Specific Editor Fields</a></h4>
<div class="paragraph">
<p>Each promulgation type may have custom editor fields at the bottom of the <em>Promulgation Type Edit Page</em>.
This may be used for editing promulgation type-specific settings.</p>
</div>
<div class="sect4">
<h5 id="navtex"><a class="anchor" href="#navtex"></a><a class="link" href="#navtex">NAVTEX</a></h5>
<div class="paragraph">
<p>The NAVTEX promulgation type has a button for managing the available transmitters (NAVTEX stations).
Clicking the button will open the <em>Transmitters</em> dialog:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/NavtexTransmitterDialog.png" alt="NAVTEX Transmitter Dialog" width="400">
</div>
</div>
<div class="paragraph">
<p>For each transmitter added via this dialog, the sysadmin can specify which areas the transmitter covers.
This will facility automatic selection of the correct transmitters when a new message is created
by executing a message template.</p>
</div>
</div>
<div class="sect4">
<h5 id="twitter-settings"><a class="anchor" href="#twitter-settings"></a><a class="link" href="#twitter-settings">Twitter Settings</a></h5>
<div class="paragraph">
<p>The Twitter promulgation type has an "Update Settings" button that opens a dialog used for managing the
format of the generated tweets, and the OAuth credential used when submitting a tweet to Twitter:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/TwitterSettingsDialog.png" alt="Twitter Settings Dialog" width="400"></span></p>
</div>
<div class="paragraph">
<p>The <em>Format</em> field may contain <em>replacement tokens</em> such as "${short-id}", "${tweet}" "${base-uri}"
and "${uid}". The tokens will be replaced with real values when a message is published.</p>
</div>
<div class="paragraph">
<p>As a example, the format "${short-id} ${tweet} ${base-uri}/#/message/${uid}" will generate a tweet
similar to the example below, that contains the message short id, the actual message-specific tweet
(title line of the message), and a link to open the full message in Niord:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/Tweet.png" alt="Tweet" width="300"></span></p>
</div>
<div class="paragraph">
<p>When the <em>Thumbnail</em> option is turned on, as in the example above, a thumbnail image will be generated
and submitted with the tweet.</p>
</div>
<div class="paragraph">
<p>The <em>API Key</em> and <em>Access Token</em> fields must be filled out with the corresponding values defined at
<a href="https://apps.twitter.com" class="bare">https://apps.twitter.com</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deleting-a-promulgation-type"><a class="anchor" href="#deleting-a-promulgation-type"></a><a class="link" href="#deleting-a-promulgation-type">6.2. Deleting a Promulgation Type</a></h3>
<div class="paragraph">
<p>A promulgation type can be deleted by clicking the trash icon next to them.
However, this only works if there is not related data associated with the promulgation type.</p>
</div>
<div class="paragraph">
<p>Instead the system administrator can choose to in-activate the promulgation type.</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-and-exporting-promulgation-types"><a class="anchor" href="#importing-and-exporting-promulgation-types"></a><a class="link" href="#importing-and-exporting-promulgation-types">6.3. Importing and Exporting Promulgation Types</a></h3>
<div class="paragraph">
<p>The system administrator can export and import promulgation types from the action menu.</p>
</div>
<div class="paragraph">
<p>The export/import file format is based on a JSON representation of the
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/promulgation/vo/PromulgationTypeVo.java">PromulgationTypeVo</a>
class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">active</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">domains</span><span class="delimiter">&quot;</span></span>: [
            { <span class="key"><span class="delimiter">&quot;</span><span class="content">domainId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">niord-client-nw</span><span class="delimiter">&quot;</span></span> }
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">language</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">messageTypes</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">COASTAL_WARNING</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NAVTEX</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">priority</span><span class="delimiter">&quot;</span></span>: <span class="integer">1</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">promulgateByDefault</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">scriptResourcePaths</span><span class="delimiter">&quot;</span></span>: [
      <span class="string"><span class="delimiter">&quot;</span><span class="content">templates/tmpl/navtex.ftl</span><span class="delimiter">&quot;</span></span>
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">serviceId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">navtex</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">typeId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">navtex</span><span class="delimiter">&quot;</span></span>
  },
  <span class="error">.</span><span class="error">.</span><span class="error">.</span>
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note, this data format does <em>not</em> include support for the promulgation type-specific attributes
such as the NAVTEX transmitters. These attributes must be handled manually.</p>
</div>
<div class="paragraph">
<p>Importing a promulgation type JSON file will trigger the <em>promulgation-type-import</em> batch job.
Batch jobs can be monitored and managed by system administrators.</p>
</div>
<div class="paragraph">
<p>As an alternative to manually uploading a promulgation type import JSON file on the <em>Promulgation Types</em>
sysadmin page, the file can be copied to the <em>$NIORD_HOME/batch-jobs/promulgation-type-import/in</em> folder.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="firing-schedules"><a class="anchor" href="#firing-schedules"></a><a class="link" href="#firing-schedules">7. Firing Schedules</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Firing Schedules</em> page allows a system administrator to configure one or more firing schedules
in Niord.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/FiringSchedulesPage.png" alt="Firing Schedules" width="400">
</div>
</div>
<div class="sect2">
<h3 id="firing-exercises-system-setup"><a class="anchor" href="#firing-exercises-system-setup"></a><a class="link" href="#firing-exercises-system-setup">7.1. Firing Exercises System Setup</a></h3>
<div class="paragraph">
<p>Before configuring a schedule on the <em>Firing Schedules</em> system admin page, the Niord system must be
configured with the proper firing areas base data and the domains for firing areas and exercises.</p>
</div>
<div class="paragraph">
<p>The overarching idea is as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Firing areas must be defined as base data on the Admin
<a href="http://docs.niord.org/admin-manual/manual.html#areas">Areas</a> page.
Each firing area implicitly has an associated firing schedule.</p>
</li>
<li>
<p>In a separate domain, "Firing Areas", editors will create a <em>Miscellaneous NM</em> message for each firing
area, which provides details about the firing area, contact information, signals, prohibition, etc.</p>
</li>
<li>
<p>The "Firing Areas" domain also has a special "Schedule" sub-page that provides a UI for easily
scheduling firing exercises per firing area.</p>
</li>
<li>
<p>The firing area messages and firing area schedule will be combined to create firing exercise
<em>Local Warning</em> messages in a separate domain, "Firing Exercises".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The schedules configured on the <em>Firing Schedules</em> system admin page provide the underlying engine
that generates firing exercise message based on firing areas and firing area schedules.</p>
</div>
<div class="paragraph">
<p>The steps outlined above are described in more details below.</p>
</div>
<div class="sect3">
<h4 id="configuring-firing-area-base-data"><a class="anchor" href="#configuring-firing-area-base-data"></a><a class="link" href="#configuring-firing-area-base-data">7.1.1. Configuring Firing Area Base Data</a></h4>
<div class="imageblock">
<div class="content">
<img src="images/FiringArea.png" alt="Firing Areas" width="600">
</div>
</div>
<div class="paragraph">
<p>Administrators must define all firing practice areas in the country on the Admin
<a href="http://docs.niord.org/admin-manual/manual.html#areas">Areas</a> page. Each of these areas should
have their type set to "Firing area". This will trigger that a firing schedule can be associated
with the areas.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-a-firing-areas-domain"><a class="anchor" href="#create-a-firing-areas-domain"></a><a class="link" href="#create-a-firing-areas-domain">7.1.2. Create a Firing Areas Domain</a></h4>
<div class="paragraph">
<p>There should be a separate domain, e.g. "Firing Areas", where editors should create
<em>Miscellaneous NM</em> messages for each firing area.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/FiringAreaMessages.png" alt="Firing Area Messages" width="600">
</div>
</div>
<div class="paragraph">
<p>The messages should provide details about the firing areas, contact information, signals, prohibition, etc.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A common task for Notices to Mariners departments is to publish a yearly publication with
     firing practice areas.
     The message list of the "Firing Areas" domain is ideally suited to form the basis for one such publication.
     The publication can be defined as described in the
     <a href="http://docs.niord.org/admin-manual/manual.html#publications">Publications</a> chapter of the administrator
     manual. Indeed, Niord ships with a report, "fa-list", that can be used for this publication.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="maintain-firing-exercise-schedule"><a class="anchor" href="#maintain-firing-exercise-schedule"></a><a class="link" href="#maintain-firing-exercise-schedule">7.1.3. Maintain Firing Exercise Schedule</a></h4>
<div class="paragraph">
<p>Once everything has been configured, a new sub-page, "Schedule", will become available in the
"Firing Areas" domain:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/FiringAreaSchedule.png" alt="Firing Area Schedule" width="600">
</div>
</div>
<div class="paragraph">
<p>Editors can maintain the firing exercise schedule on this page.
Firstly, they select a date in the <em>Schedule Date</em> field. The firing practice schedule of that date
will be displayed below for all available firing areas.</p>
</div>
<div class="paragraph">
<p>The editor can add and modify the firing period for a given area by clicking the pencil symbol next
to the area.</p>
</div>
<div class="paragraph">
<p>Clicking the "Update Firing Exercises" button will directly update firing exercise messages from
the updated schedule. This operation is also called periodically by the system.</p>
</div>
</div>
<div class="sect3">
<h4 id="generating-firing-exercises"><a class="anchor" href="#generating-firing-exercises"></a><a class="link" href="#generating-firing-exercises">7.1.4. Generating Firing Exercises</a></h4>
<div class="paragraph">
<p>Once everything has been configured, the firing area messages and firing exercise schedule maintained
in the "Firing Areas" domain will be combined to created firing exercise messages in a new domain,
e.g. "Firing Exercises".</p>
</div>
<div class="paragraph">
<p>No editor should have access rights to edit messages in the "Firing Exercises" domain, since these
are generated by the system.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-firing-schedule"><a class="anchor" href="#adding-or-editing-a-firing-schedule"></a><a class="link" href="#adding-or-editing-a-firing-schedule">7.2. Adding or Editing a Firing Schedule</a></h3>
<div class="paragraph">
<p>A prerequisite for the firing exercise-generating mechanism to work, and for the schedule page
to become available in the "Firing Areas" domain, is that a firing schedule has been defined
on the <em>Firing Schedules</em> system admin page.</p>
</div>
<div class="paragraph">
<p>The sysadmin can add a new schedule by clicking the "New Firing Schedule" button, or edit an existing
schedule by clicking the pencil symbol next to the schedule.</p>
</div>
<div class="paragraph">
<p>This will open the <em>Firing Schedule Edit Page</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/FiringScheduleEditPage.png" alt="Firing Schedule Editor Page" width="600">
</div>
</div>
<div class="paragraph">
<p>The schedule attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Schedule Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The domain that is used for maintaining the firing area messages. The domain selected in this
  field will automatically sport a "Schedule" page, used for maintaining the firing schedule
  as described above.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target Domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The target domain, where the generated firing exercise messages will be created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target Message Series</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message series of the target domain, that will be assigned to the generated firing exercise messages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schedule Days</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of days into the future that will be included in the generated firing exercises.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Firing exercise messages will be created automatically only when the <em>Active</em> flag is checked.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="deleting-a-firing-schedule"><a class="anchor" href="#deleting-a-firing-schedule"></a><a class="link" href="#deleting-a-firing-schedule">7.3. Deleting a Firing Schedule</a></h3>
<div class="paragraph">
<p>A firing schedule can be deleted by clicking the trash icon next to them.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dictionaries"><a class="anchor" href="#dictionaries"></a><a class="link" href="#dictionaries">8. Dictionaries</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Dictionaries</em> page allows a system administrator to manage the named dictionaries used in Niord.
The dictionaries contain translatable text used in the Niord website, in PDF reports, e-mails,
template parameter lists, etc.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DictionariesPage.png" alt="Dictionaries" width="600">
</div>
</div>
<div class="paragraph">
<p>The topmost menu is used to select the currently selected dictionary.</p>
</div>
<div class="paragraph">
<p>The sysadmin may filter the list of dictionary entries, displayed for the currently selected dictionary,
by typing a term into the <em>Filter</em> input field.
The term is matched against the key of the dictionary entries.</p>
</div>
<div class="sect2">
<h3 id="standard-dictionaries"><a class="anchor" href="#standard-dictionaries"></a><a class="link" href="#standard-dictionaries">8.1. Standard Dictionaries</a></h3>
<div class="paragraph">
<p>Niord defines a set of standard dictionaries, that are initially loaded from <em>resource bundles</em> in
the Niord distribution.
The standard dictionaries are:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Dictionary</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">web</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The "web" dictionary contains much of the text actually displayed on the Niord website.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The "message" dictionary contains many of the terms used for NW and NM messages, and is used
  in the Niord website, PDF reports, e-mails, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The "mail" dictionary contains additional translatable terms used in e-mails.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pdf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The "pdf" dictionary contains additional translatable terms used in PDF reports.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The "template" dictionary contains additional translatable terms used when executing message templates.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="extended-dictionaries"><a class="anchor" href="#extended-dictionaries"></a><a class="link" href="#extended-dictionaries">8.2. Extended Dictionaries</a></h3>
<div class="paragraph">
<p>Niord also supports importing <em>extended dictionaries</em>, as detailed in the
<a href="#importing-and-exporting-dictionaries">Importing and Exporting Dictionaries</a> section.</p>
</div>
<div class="paragraph">
<p>The entries of these dictionaries have an extra translatable <em>long value</em> field, which can be
viewed and edited by checking the "Show Extended" option, next to the dictionary menu:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DictionariesExtendedPage.png" alt="Extended Dictionaries" width="600">
</div>
</div>
<div class="paragraph">
<p>One such dictionary is the "aton" dictionary, which contain parameter list entries used in the
message template function - please refer to the
<a href="http://docs.niord.org/editor-manual/manual.html#message-template-execution">Message Template Execution</a>
chapter.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-dictionary-entry"><a class="anchor" href="#adding-or-editing-a-dictionary-entry"></a><a class="link" href="#adding-or-editing-a-dictionary-entry">8.3. Adding or Editing a Dictionary Entry</a></h3>
<div class="paragraph">
<p>The sysadmin can add a new dictionary entry to the currently selected dictionary by clicking the
"New Entry" button, or edit an existing dictionary entry by clicking the pencil symbol next to the entry.</p>
</div>
<div class="paragraph">
<p>This will open the <em>Dictionary Entry Edit Page</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DictionaryEntryEditPage.png" alt="Dictionary Entry Editor Page" width="400">
</div>
</div>
<div class="paragraph">
<p>The standard dictionary entry attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entry Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique key for the dictionary entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The textual values for all supported languages.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For extended dictionaries - i.e. when the "Show Extended" option is checked - there are a
couple of additional attributes. These entries are typically used in parameter lists when executing
message templates - please refer to the
<a href="http://docs.niord.org/editor-manual/manual.html#message-template-execution">Message Template Execution</a>
chapter.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DictionaryEntryExtendedEditPage.png" alt="Dictionary Entry Extended Editor Page" width="400">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entry Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A secondary version of the dictionary entry for all supported languages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AtoN filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>AtoN</em> filter is not currently used in production, but it ties in with the <em>Aids to Navigation</em> module
  of Niord. There, you can start by selecting an AtoN and then execute a message template based on the AtoN
  data.
  The <em>AtoN filter</em> attribute can be used to facilitate pre-selection of the correct parameters in the
  message templates. For instance, in the example above the "north cardinal buoy" entry matches AtoNs according
  to the filter: "aton.kv(<em>'seamark:buoy_cardinal:category</em>', <em>'north</em>') &amp;&amp; !aton.k(<em>'seamark:light.*</em>')".
  AtoNs are defined in an
  <a href="http://wiki.openstreetmap.org/wiki/Seamarks/Seamark_Objects">OpenStreetmap (OSM) Seamark</a> format, and thus,
  the filter states that the AtoN should be a north cardinal buoy, but not a light buoy.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="deleting-a-dictionary-entry"><a class="anchor" href="#deleting-a-dictionary-entry"></a><a class="link" href="#deleting-a-dictionary-entry">8.4. Deleting a Dictionary Entry</a></h3>
<div class="paragraph">
<p>A dictionary entry can be deleted by clicking the trash icon next to them.</p>
</div>
<div class="paragraph">
<p>Be careful that the dictionary entry is not used in on of the <a href="#parameter-types">Parameter Types</a> definitions.</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-and-exporting-dictionaries"><a class="anchor" href="#importing-and-exporting-dictionaries"></a><a class="link" href="#importing-and-exporting-dictionaries">8.5. Importing and Exporting Dictionaries</a></h3>
<div class="paragraph">
<p>The system administrator can export and import dictionaries from the action menu.</p>
</div>
<div class="paragraph">
<p>The export/import file format is based on a JSON representation of the
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/dictionary/vo/ExportedDictionaryVo.java">ExportedDictionaryVo</a>
class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">mail</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">entries</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">descs</span><span class="delimiter">&quot;</span></span>: [
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">da</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">K</span><span class="char">\u00e6</span><span class="content">re {0}</span><span class="delimiter">&quot;</span></span>
          },
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Dear {0}</span><span class="delimiter">&quot;</span></span>
          }
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">mail.dear.user</span><span class="delimiter">&quot;</span></span>
      },
      <span class="error">.</span><span class="error">.</span><span class="error">.</span>
    ],
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importing a dictionary JSON file will trigger the <em>dictionary-import</em> batch job.
Batch jobs can be monitored and managed by system administrators.</p>
</div>
<div class="paragraph">
<p>As an alternative to manually uploading a <em>dictionary import JSON file on the _Dictionaries</em> sysadmin page,
the file can be copied to the <em>$NIORD_HOME/batch-jobs/dictionary-import/in</em> folder.</p>
</div>
</div>
<div class="sect2">
<h3 id="reloading-standard-dictionaries"><a class="anchor" href="#reloading-standard-dictionaries"></a><a class="link" href="#reloading-standard-dictionaries">8.6. Reloading Standard Dictionaries</a></h3>
<div class="paragraph">
<p>As mentioned in the <a href="#standard-dictionaries">Standard Dictionaries</a> section, the standard dictionaries are initially loaded from
<em>resource bundles</em> in the Niord distribution.</p>
</div>
<div class="paragraph">
<p>These dictionaries can be re-loaded from the resource bundles by enacting the "Reload from system"
function in the action menu.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="parameter-types"><a class="anchor" href="#parameter-types"></a><a class="link" href="#parameter-types">9. Parameter Types</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Parameter Types</em> page allows a system administrator to manage named parameters that
may be used for user input when executing message templates - please refer to the
<a href="http://docs.niord.org/editor-manual/manual.html#message-template-execution">Message Template Execution</a>
chapter.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ParameterTypesPage.png" alt="Parameter Types" width="600">
</div>
</div>
<div class="paragraph">
<p>There are three categories of parameter types:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">There is a fixed set of <em>standard</em> parameter types, such as "text", "number",
  "boolean", "date", etc. These types cannot be modified or deleted.
  When executing a message template, parameters of the <em>standard</em> type will
  be represented via standard input widgets such as an input field for "text",
  a checkbox for "boolean", etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">list</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <em>list</em> parameter type is a named and ordered collection of dictionary entries - please refer
  to the <a href="#dictionaries">Dictionaries</a> chapter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">composite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <em>composite</em> parameter type is a named collection of <em>standard</em> and <em>list</em> parameter types.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example: When executing the "Marked Wreck" message template, one of the parameters the user
is asked to fill out, is the "Wreck" parameter:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ParameterTypeExample.png" alt="Parameter Type Example" width="600">
</div>
</div>
<div class="paragraph">
<p>The "Wreck" parameter is really just a <em>composite</em> parameter made up of a <em>list</em> parameter type
("vessel_type_list") for specifying the wreck type, a <em>standard</em> parameter type ("number") for
specifying the wreck depth, and a <em>standard</em> parameter type ("boolean") for specifying if the
wreck is visible above sea surface.</p>
</div>
<div class="paragraph">
<p>The "vessel_type_list" <em>list</em> parameter type in turn includes the "aton" dictionary entries for
"vessel", "fishing vessel" and "sailing vessel".</p>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-parameter-type"><a class="anchor" href="#adding-or-editing-a-parameter-type"></a><a class="link" href="#adding-or-editing-a-parameter-type">9.1. Adding or Editing a Parameter Type</a></h3>
<div class="paragraph">
<p>The sysadmin can add a new parameter type by clicking the "New Parameter Type" button, and then select
either "List Parameter Type" or "Composite Parameter Type":</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ParameterTypeAddBtn.png" alt="Parameter Type Add Button" width="120">
</div>
</div>
<div class="paragraph">
<p>Similarly, the sysadmin can edit an existing <em>list</em> or <em>composite</em> (but not <em>standard</em>) parameter type
by clicking the pencil symbol next to the entry.</p>
</div>
<div class="paragraph">
<p>This will open either the <em>List Parameter Type Edit Page</em> or the <em>Composite Parameter Type Edit Page</em>:</p>
</div>
<div class="sect3">
<h4 id="list-parameter-type-edit-page"><a class="anchor" href="#list-parameter-type-edit-page"></a><a class="link" href="#list-parameter-type-edit-page">9.1.1. List Parameter Type Edit Page</a></h4>
<div class="imageblock">
<div class="content">
<img src="images/ParameterTypesListEditPage.png" alt="List Parameter Type Editor Page" width="600">
</div>
</div>
<div class="paragraph">
<p>The sysadmin specifies a unique name for the parameter list, and assigns the relevant dictionary
entries to the list. For a discussion of dictionaries, please refer to the <a href="#dictionaries">Dictionaries</a>
chapter.</p>
</div>
<div class="paragraph">
<p>The sysadmin can select the relevant dictionary using the dictionary menu in the top of the
"Available values" panel. She can also filter the entries of the currently selected dictionary
using the <em>Filter</em> input field.</p>
</div>
<div class="paragraph">
<p>Dictionary entries are added to the list by clicking the plus icon next to the entries.
Similarly, dictionary entries are removed from the parameter type list by clicking the
trash icon next to the entries in the "Selected Values" panel.
Lastly, selected dictionary entries can be re-ordered by dragging an entry
to its proper position using the <span class="image"><img src="images/DragHandle.png" alt="Drag Handle" width="16"></span> drag handle.</p>
</div>
</div>
<div class="sect3">
<h4 id="composite-parameter-type-edit-page"><a class="anchor" href="#composite-parameter-type-edit-page"></a><a class="link" href="#composite-parameter-type-edit-page">9.1.2. Composite Parameter Type Edit Page</a></h4>
<div class="imageblock">
<div class="content">
<img src="images/ParameterTypesCompositeEditPage.png" alt="Composite Parameter Type Editor Page" width="500">
</div>
</div>
<div class="paragraph">
<p>The sysadmin specifies a unique name for the composite parameter, and assigns the relevant nested
parameters.</p>
</div>
<div class="paragraph">
<p>The sysadmin adds a new nested parameter by clicking the "Add" button, and edits the nested
parameters by clicking the pencil icon next to the parameters.
This will open the <em>Nested Composite Parameter Edit Dialog</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ParameterTypesCompositeDialog.png" alt="Nested Composite Parameter Edit Dialog" width="500">
</div>
</div>
<div class="paragraph">
<p>The nested parameter must be assigned a unique <em>Parameter ID</em>, a <em>Name</em> in all supported languages,
a <em>Type</em> which can be any of the defined <em>standard</em> or <em>list</em> parameter types.</p>
</div>
<div class="paragraph">
<p>Furthermore, the sysadmin must decide whether the parameter should be mandatory, and if the
parameter is tied to a position list.</p>
</div>
<div class="paragraph">
<p>Tying a nested parameter type to a position list will ensure the following effect:
When executing a message template, the parameter will be repeated for each position defined
for the message. In the example below, the "Buoy" parameter is repeated for both positions
selected in the <em>Positions</em> editor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ParameterTypeExample2.png" alt="Parameter Type Example" width="600">
</div>
</div>
<div class="paragraph">
<p>Nested parameters can be deleted from the <em>composite</em> parameter type by clicking the trash
icon next to the parameters.</p>
</div>
<div class="paragraph">
<p>Lastly, the nested parameters can be re-arranged by dragging a parameter
to its proper position using the <span class="image"><img src="images/DragHandle.png" alt="Drag Handle" width="16"></span> drag handle.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deleting-a-parameter-type"><a class="anchor" href="#deleting-a-parameter-type"></a><a class="link" href="#deleting-a-parameter-type">9.2. Deleting a Parameter Type</a></h3>
<div class="paragraph">
<p>A parameter type can be deleted by clicking the trash icon next to them.
However, the sysadmin should first check that the parameter is not used in either message
template definitions (see the <a href="#categories">Categories</a> chapter) or in <em>composite</em> parameter types.</p>
</div>
</div>
<div class="sect2">
<h3 id="duplicating-a-parameter-type"><a class="anchor" href="#duplicating-a-parameter-type"></a><a class="link" href="#duplicating-a-parameter-type">9.3. Duplicating a Parameter Type</a></h3>
<div class="paragraph">
<p>A parameter type can be duplicated by clicking the copy icon next to them.</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-and-exporting-parameter-types"><a class="anchor" href="#importing-and-exporting-parameter-types"></a><a class="link" href="#importing-and-exporting-parameter-types">9.4. Importing and Exporting Parameter Types</a></h3>
<div class="paragraph">
<p>The system administrator can export and import parameter types from the action menu.</p>
</div>
<div class="paragraph">
<p>The export/import file format is based on a JSON representation of the
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/category/vo/ParamTypeVo.java">ParamTypeVo</a> class and its sub-classes:
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/category/vo/StandardParamTypeVo.java">StandardParamTypeVo</a>,
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/category/vo/ListParamTypeVo.java">ListParamTypeVo</a> and
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/category/vo/CompositeParamTypeVo.java">CompositeParamTypeVo</a>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ais</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">COMPOSITE</span><span class="delimiter">&quot;</span></span>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">templateParams</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">descs</span><span class="delimiter">&quot;</span></span>: [
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">da</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Afm</span><span class="char">\u00e6</span><span class="content">rk. type</span><span class="delimiter">&quot;</span></span>
          },
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">AtoN Type</span><span class="delimiter">&quot;</span></span>
          }
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">mandatory</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">paramId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">aton_type</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">positionList</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">radio_navigation_aton_list</span><span class="delimiter">&quot;</span></span>
      },
      <span class="error">.</span><span class="error">.</span><span class="error">.</span>
    ]
  },
  <span class="error">.</span><span class="error">.</span><span class="error">.</span>
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importing a parameter type JSON file will trigger the <em>param-type-import</em> batch job.
Batch jobs can be monitored and managed by system administrators.</p>
</div>
<div class="paragraph">
<p>As an alternative to manually uploading a parameter type import JSON file on the
<em>Parameter Types</em> sysadmin page,
the file can be copied to the <em>$NIORD_HOME/batch-jobs/param-type-import/in</em> folder.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="script-resources"><a class="anchor" href="#script-resources"></a><a class="link" href="#script-resources">10. Script Resources</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Script Resources</em> page allows a system administrator to manage the list of <em>script resources</em>
in Niord.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ScriptResourcesPage.png" alt="Script Resources" width="800">
</div>
</div>
<div class="paragraph">
<p>Script resources are always associated with a path, and come in two flavours; <em>Freemarker templates</em>
(with an ".ftl" path extension) and server-side Nashorn <em>JavaScript</em> files (with a ".js" path extension).</p>
</div>
<div class="paragraph">
<p>System administrators wishing to work with script resources, should acquaint themselves with these
technologies, which are detailed further in the <a href="#server-side-javascript">Server-Side JavaScript</a> and <a href="#freemarker-templates">Freemarker Templates</a>
sections.</p>
</div>
<div class="paragraph">
<p>The Freemarker templates are typically, but not exclusively, used for generating HTML, whereas the
server-side JavaScript files are typically used for looking up or manipulating data.</p>
</div>
<div class="paragraph">
<p>The <em>Script Resources Page</em> displays the list of script resources currently persisted to the database.
The system administrator can type a term into the <em>Filter</em> input field above the list, to filter
the script resources by their paths.</p>
</div>
<div class="sect2">
<h3 id="script-resource-usage"><a class="anchor" href="#script-resource-usage"></a><a class="link" href="#script-resource-usage">10.1. Script Resource Usage</a></h3>
<div class="paragraph">
<p>The script resources are used throughout Niord for operations such as generating PDF print reports,
generating mails, etc. An overview of functions using script resources is found in the table below:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print Reports</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print Reports are maintained on the <a href="#print-reports">Print Reports</a> sysadmin page. There are a couple of standard
  and draft reports, along with domain-specific reports, such as the weekly Notices to Mariners digest.
  In order to generate PDF files, Niord will first use Freemarker templates to generate HTML, and then
  convert the HTML into PDF (CSS 2 has extensions for <em>paged media</em>).
  Print Report Freemarker templates are typically found under the "templates/messages/" sub-path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Templates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The single most extensive usage of script resources is for <em>Message Templates</em> -  please refer to
  the subsequent <a href="#intermediate-message-template-format">Intermediate Message Template Format</a> section.
  Message Templates use JavaScript file for data-manipulation and Freemarker templates for generating
  an intermediate template XML-format, used for generating messages.
  Message Template script resources are typically found under the "templates/tmpl/" sub-path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mailing Lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mailing lists also use script resources for generating the actual HTML e-mails - please refer to the
  <a href="#Mailing Lists">[Mailing Lists]</a> chapter.
  Mailing List script resources are typically found under the "templates/mailinglist/" sub-path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Miscellaneous</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Freemarker templates are used for quite a few discrete functions, such as formatting a light
  character (e.g. "Al.Bu.Y 3s") as human text, and formatting message positions in various formats
  - please see the <a href="http://docs.niord.org/editor-manual/manual.html#insert-locations">Insert Locations</a>
  section of the Editors manual.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="script-resource-extensions"><a class="anchor" href="#script-resource-extensions"></a><a class="link" href="#script-resource-extensions">10.2. Script Resource Extensions</a></h3>
<div class="paragraph">
<p>Niord has added some extensions to both types of the script resources.</p>
</div>
<div class="paragraph">
<p>Firstly, the script resources are <em>always</em> loaded from the database, not the file system.
However, if a script resource, as given by its path, does not exist in the database, then
Niord will check to see if the resource can be loaded from the class-path and persisted
to the database, thence commencing operations.</p>
</div>
<div class="paragraph">
<p>This means that Niord developers can develop and maintain the initial batch of script resources
as project files and use a professional code editor for editing the scripts.</p>
</div>
<div class="paragraph">
<p>Another Niord extension has to do with <em>script resource inclusion</em>. File system-based Freemarker Templates
can  include other Freemarker templates, and similarly for JavaScript files; a trait that facilitates
code reuse and libraries.
Niord has extended the <em>script resource inclusion</em> concept, so that it works with the database-backed
scripts as well. Subsequent sections will give examples of script resource inclusion.</p>
</div>
</div>
<div class="sect2">
<h3 id="server-side-javascript"><a class="anchor" href="#server-side-javascript"></a><a class="link" href="#server-side-javascript">10.3. Server-Side JavaScript</a></h3>
<div class="paragraph">
<p>An introduction to Nashorn JavaScript can be found at
<a href="http://winterbe.com/posts/2014/04/05/java8-nashorn-tutorial/" class="bare">http://winterbe.com/posts/2014/04/05/java8-nashorn-tutorial/</a>.</p>
</div>
<div class="paragraph">
<p>The scripts are executed server-side, which means that you can e.g. call Java Enterprise Beans and
load and manipulate data.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Executing JavaScripts server-side is clearly a security issue, since you can e.g. create
a script that deletes data. However, all access to create and update JavaScripts is strictly
restricted to system administrators, a role reserved to the person(s) that set up and configure
the entire system, and who can wreck it anyway, should they so decide&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example illustrates how to perform a message search for published firing exercises:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">var</span> messageService = CdiUtils.getBean(org.niord.core.message.MessageService.<span class="reserved">class</span>);
<span class="keyword">var</span> seriesIds = java.util.Collections.singleton(<span class="string"><span class="delimiter">'</span><span class="content">dma-fe</span><span class="delimiter">'</span></span>);
<span class="keyword">var</span> statuses = java.util.Collections.singleton(org.niord.model.message.Status.PUBLISHED);
<span class="keyword">var</span> searchParams = <span class="keyword">new</span> org.niord.core.message.MessageSearchParams();
searchParams.seriesIds(seriesIds)
    .statuses(statuses);
<span class="keyword">var</span> searchResult = messageService.search(searchParams);</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="inclusion-in-javascript"><a class="anchor" href="#inclusion-in-javascript"></a><a class="link" href="#inclusion-in-javascript">10.3.1. Inclusion in JavaScript</a></h4>
<div class="paragraph">
<p>As mentioned in the <a href="#script-resource-extensions">Script Resource Extensions</a> section, JavaScript files are persisted in the
database, and may include other JavaScript files.</p>
</div>
<div class="paragraph">
<p>Hence, the "templates/tmpl/common.js" JavaScript file contains a collection of common JavaScript functions
which is often included by other JavaScript files using the syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">/** Always load using full path and a &quot;niord:&quot; prefix **/</span>
load(<span class="string"><span class="delimiter">'</span><span class="content">niord:templates/tmpl/common.js</span><span class="delimiter">'</span></span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="freemarker-templates"><a class="anchor" href="#freemarker-templates"></a><a class="link" href="#freemarker-templates">10.4. Freemarker Templates</a></h3>
<div class="paragraph">
<p>The documentation for Freemarker templates are found at <a href="http://freemarker.org" class="bare">http://freemarker.org</a>.</p>
</div>
<div class="paragraph">
<p>The Freemarker Templates are typically used to convert a data model, such as a message list,
into HTML, and sometimes into plain text or XML.</p>
</div>
<div class="paragraph">
<p>The following simple example, "templates/geometry/text.ftl", is instantiated with a "geometry"
(position list) and a "format", and formats the positions as a comma-separated list of lat-lon positions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="error">&lt;</span>#assign formatPos = &quot;org.niord.core.script.directive.LatLonDirective&quot;?new()<span class="error">&gt;</span>

<span class="error">&lt;</span>#if geometry?has_content<span class="error">&gt;</span>
    <span class="error">&lt;</span>#list geometry as feature<span class="error">&gt;</span>
        <span class="error">&lt;</span>#if feature.coordinates?has_content<span class="error">&gt;</span>
            <span class="error">&lt;</span>#list feature.coordinates as coord<span class="error">&gt;</span>
                <span class="error">&lt;</span>@formatPos lat=coord.coordinates[1] lon=coord.coordinates[0] format=format /<span class="error">&gt;</span>
                <span class="error">&lt;</span>#if coord?has_next<span class="error">&gt;</span>,<span class="entity">&amp;nbsp;</span><span class="tag">&lt;/</span>#if<span class="error">&gt;</span>
            <span class="tag">&lt;/</span>#list<span class="error">&gt;</span>
        <span class="tag">&lt;/</span>#if<span class="error">&gt;</span>
        <span class="error">&lt;</span>#if feature?has_next<span class="error">&gt;</span>,<span class="entity">&amp;nbsp;</span><span class="tag">&lt;/</span>#if<span class="error">&gt;</span>
    <span class="tag">&lt;/</span>#list<span class="error">&gt;</span>
<span class="tag">&lt;/</span>#if<span class="error">&gt;</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="inclusion-in-freemarker-templates"><a class="anchor" href="#inclusion-in-freemarker-templates"></a><a class="link" href="#inclusion-in-freemarker-templates">10.4.1. Inclusion in Freemarker Templates</a></h4>
<div class="paragraph">
<p>As mentioned in the <a href="#script-resource-extensions">Script Resource Extensions</a> section, Freemarker templates are persisted in the
database, and may include other Freemarker templates.</p>
</div>
<div class="paragraph">
<p>Hence, the "templates/tmpl/common.ftl" and "templates/messages/message-support.ftl" Freemarker templates
contain a collection of common Freemarker functions and macros used by other Freemarker templates,
using the syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- From same path level --&gt;</span>
<span class="error">&lt;</span>#include &quot;common.ftl&quot;/<span class="error">&gt;</span>

<span class="comment">&lt;!-- Include from a different path level --&gt;</span>
<span class="error">&lt;</span>#include &quot;../tmpl/common.ftl&quot;/<span class="error">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="language-specific-freemarker-templates"><a class="anchor" href="#language-specific-freemarker-templates"></a><a class="link" href="#language-specific-freemarker-templates">10.4.2. Language-Specific Freemarker Templates</a></h4>
<div class="paragraph">
<p>When loading the main Freemarker template path, or any of the included templates (see above),
the actual template path loaded is subject to a language-specific selection.</p>
</div>
<div class="paragraph">
<p>If e.g. "templates/aton/light-character.ftl" is loaded in the context of a Danish locale,
then the actual template being loaded is the "templates/aton/light-character_da.ftl" template
(if it exists).</p>
</div>
</div>
<div class="sect3">
<h4 id="dictionaries-in-freemarker-templates"><a class="anchor" href="#dictionaries-in-freemarker-templates"></a><a class="link" href="#dictionaries-in-freemarker-templates">10.4.3. Dictionaries in Freemarker Templates</a></h4>
<div class="paragraph">
<p>As described in the <a href="#dictionaries">Dictionaries</a> chapter, dictionaries are also used in Freemarker Templates.
As an example, the "message" and "mail" dictionaries are available to mailing-list Freemarker
templates, the "message" and "pdf" are available to print report Freemarker templates, and so
forth. The following examples demonstrate how to emit a dictionary term:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- Emitting the &quot;pdf.toc&quot; dictionary entry --&gt;</span>
<span class="tag">&lt;h2&gt;</span>${text(&quot;pdf.toc&quot;)}<span class="tag">&lt;/h2&gt;</span>

<span class="comment">&lt;!-- Emitting a parameterized dictionary entry which contains a {0} placeholder --&gt;</span>
${text('cancellation.this_message',cancelDate)}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="intermediate-message-template-format"><a class="anchor" href="#intermediate-message-template-format"></a><a class="link" href="#intermediate-message-template-format">10.5. Intermediate Message Template Format</a></h3>
<div class="paragraph">
<p>Freemarker templates are used for generating an intermediate XML-based <em>Message Template Format</em>.
Message templates are used so extensively, that the format merits its own description below.
Please also refer to the <a href="#categories">Categories</a> and
<a href="http://docs.niord.org/editor-manual/manual.html#message-template-execution">Message Template Execution</a>
chapters.</p>
</div>
<div class="paragraph">
<p>The data passed along to the Freemarker template being executed is</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A template NW or NM message instantiated from input fields in the template execution dialog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">params</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A map of other parameters instantiated from input fields in the template execution dialog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message template (executable category) being executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">languages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The list of model languages to generate data for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The output of the Freemarker templates should be an intermediate XML format, which contain a list
of &lt;field-template&gt; elements for each field that should be updated of the message.
The snippet below illustrates what the resulting XML may look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;field-template</span> <span class="attribute-name">field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">part.getDesc('en').subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    Denmark. Kattegat. Randers Fiord. Light unlit.
<span class="tag">&lt;/field-template&gt;</span>

<span class="tag">&lt;field-template</span> <span class="attribute-name">field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">part.getDesc('da').subject</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    Danmark. Kattegat. Randers Fjord. Fyr slukket.
<span class="tag">&lt;/field-template&gt;</span>

<span class="tag">&lt;field-template</span> <span class="attribute-name">field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">part.getDesc('en').details</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">html</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>The light Voer Brohoved in pos. 56<span class="entity">&amp;deg;</span> 31.2'N - 010<span class="entity">&amp;deg;</span> 13.8'E is unlit.<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/field-template&gt;</span>

<span class="tag">&lt;field-template</span> <span class="attribute-name">field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">part.getDesc('da').details</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">format</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">html</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;p&gt;</span>Fyret Voer Brohoved p<span class="entity">&amp;aring;</span> pos. 56<span class="entity">&amp;deg;</span> 31,2'N - 010<span class="entity">&amp;deg;</span> 13,8'E er slukket.<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/field-template&gt;</span>

<span class="tag">&lt;field-template</span> <span class="attribute-name">field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">message.promulgation('audio').text</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">update</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">append</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    Fyret Voer Brohoved p position 56 grader 31,2 min. nord 10 grader 13,8 min. st er slukket.
<span class="tag">&lt;/field-template&gt;</span>

<span class="tag">&lt;field-template</span> <span class="attribute-name">field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">message.promulgation('navtex').text</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">update</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">append</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    LIGHT VOER BROHOVED 56-31.2N 010-13.8E
    UNLIT.
<span class="tag">&lt;/field-template&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The "field" attribute (which is actually a JavaScript expression), is used to point out
which message attribute to update with the contents of the &lt;field-template&gt;.</p>
</div>
<div class="paragraph">
<p>The "update" attribute indicates whether to replace or append the content to the attribute.</p>
</div>
<div class="paragraph">
<p>The "format" attribute indicates the format of the &lt;field-template&gt; contents. If the format is e.g.
"text", then the contents is cleaned up as a single line of text.</p>
</div>
<div class="paragraph">
<p>Unlike most other types of script resources, which gets instantiated with a specific language and
locale, the ones used for message templates should handle multiple languages themselves.
The currently used language can be changed using the following snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="error">&lt;</span>#setting locale='da'<span class="error">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-script-resource"><a class="anchor" href="#adding-or-editing-a-script-resource"></a><a class="link" href="#adding-or-editing-a-script-resource">10.6. Adding or Editing a Script Resource</a></h3>
<div class="paragraph">
<p>The sysadmin can add a new Freemarker Template or JavaScript file by clicking the "Add Script Resource"
button, and select the type to add:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ScriptResourcesAddBtn.png" alt="Add Script Resource Button" width="120">
</div>
</div>
<div class="paragraph">
<p>Similarly, the sysadmin may edit an existing script resource by clicking the pencil icon next to the
script resource.</p>
</div>
<div class="paragraph">
<p>The editor for the script being added or edited, contains two fields; the script resource path and
the actual script:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ScriptResourceEditor.png" alt="Script Resource Editor" width="500">
</div>
</div>
<div class="paragraph">
<p>The script editor has syntax coloring to aid and facilitate the editing process.</p>
</div>
</div>
<div class="sect2">
<h3 id="script-resource-revisions"><a class="anchor" href="#script-resource-revisions"></a><a class="link" href="#script-resource-revisions">10.7. Script Resource Revisions</a></h3>
<div class="paragraph">
<p>Script resources are versioned, in the sense that every time the sysadmin edits and saves a script
resource, a new revision is stored.
The revisions of a script resource can be inspected by clicking the "History" button, which opens the
<em>Script Resource History</em> dialog:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ScriptResourceHistory.png" alt="Script Resource History Dialog" width="500">
</div>
</div>
<div class="paragraph">
<p>An earlier revision of the script can be inspected by clicking the checkbox next to the revision.
If two revisions are selected (as above), the dialog will display the differences using color coding.</p>
</div>
</div>
<div class="sect2">
<h3 id="deleting-a-script-resource"><a class="anchor" href="#deleting-a-script-resource"></a><a class="link" href="#deleting-a-script-resource">10.8. Deleting a Script Resource</a></h3>
<div class="paragraph">
<p>A script resource can be deleted by clicking the trash icon next to them.
However, the sysadmin should first carefully check if the script resource is referenced in mailing lists,
print reports, message templates, or indeed included in other script resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="reloading-script-resources"><a class="anchor" href="#reloading-script-resources"></a><a class="link" href="#reloading-script-resources">10.9. Reloading Script Resources</a></h3>
<div class="paragraph">
<p>As described in the <a href="#script-resource-extensions">Script Resource Extensions</a> chapter, script resources may originate from files
in the Niord class-path, before being loaded into the database.
Any subsequent changes to a script resources will (naturally) only update the version in the database,
which may thus come out of sync with the class-path file.</p>
</div>
<div class="paragraph">
<p>If the sysadmin enacts the "Reload files" function from the action menu, all script resources in the
database will be overridden with any corresponding version in the class-path.</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-and-exporting-script-resource"><a class="anchor" href="#importing-and-exporting-script-resource"></a><a class="link" href="#importing-and-exporting-script-resource">10.10. Importing and Exporting Script Resource</a></h3>
<div class="paragraph">
<p>The system administrator can export and import script resources from the action menu.</p>
</div>
<div class="paragraph">
<p>The export/import file format is based on a JSON representation of the
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/script/vo/ScriptResourceVo.java">ScriptResourceVo</a>
class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="content">&lt;#macro formatLightCharacterPhase phase multiple=false &gt;</span><span class="char">\n</span><span class="content">   ...</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">templates/aton/light-character.ftl</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">FM</span><span class="delimiter">&quot;</span></span>
  },
  <span class="error">.</span><span class="error">.</span><span class="error">.</span>
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importing a script resource JSON file will trigger the <em>script-resource-import</em> batch job.
Batch jobs can be monitored and managed by system administrators.</p>
</div>
<div class="paragraph">
<p>As an alternative to manually uploading a script resource import JSON file on the <em>Script Resource</em>
sysadmin page, the file can be copied to the <em>$NIORD_HOME/batch-jobs/script-resource-import/in</em> folder.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="categories"><a class="anchor" href="#categories"></a><a class="link" href="#categories">11. Categories</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Categories</em> page allows a system administrator to manage the the hierarchical tree of
categories in Niord.
Lists of categories may be associated with notices to mariners and navigational warnings,
and can be used for filtering message search results.</p>
</div>
<div class="paragraph">
<p>Furthermore, categories may be executable, in which case they can be used to generate messages
from user input, as described in the
<a href="http://docs.niord.org/editor-manual/manual.html#message-template-execution">Message Template Execution</a>
chapter.
Hence, executable categories are synonymously known as <em>message templates</em>, or just <em>templates</em>,
throughout the Niord documentation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CategoriesPage.png" alt="Categories" width="600">
</div>
</div>
<div class="paragraph">
<p>The category tree is navigated like a file system directory.
Additionally, the user may filter the categories by typing a term into the <em>Filter Categories</em> input field
above the category tree. The term is matched against the name of the categories.</p>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-category"><a class="anchor" href="#adding-or-editing-a-category"></a><a class="link" href="#adding-or-editing-a-category">11.1. Adding or Editing a Category</a></h3>
<div class="paragraph">
<p>The user can add a new category by clicking the "Add" button, or edit a category by selecting it in
the category tree.</p>
</div>
<div class="paragraph">
<p>When adding a new category, it will be a child-category of the currently selected category in the
category tree. If no category is selected, the new category will become a new root category.</p>
</div>
<div class="paragraph">
<p>The details of the new or edited category will be present in the <em>Category Editor Panel</em> next to the
category tree (see screenshot above).</p>
</div>
<div class="paragraph">
<p>The common editable attributes for both types of categories are listed below:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only an active category can be assigned to a message or executed as a message template.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the category in all supported model languages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optionally, specify a <em>Maritime Resource Name</em> (a unique URN) for the category. Defining MRNs for
  categories will facilitate better integration between Niord systems of different countries.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional Editor Fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can be used to enable extra fields in the message editor when the category is assigned to the message.
  As an example, if a "Firing Exercises" category is assigned to a navigational warning, it might make
  sense to show the "Signals" editor field, not normally enabled for navigational warnings, in the
  message editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AtoN filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>AtoN</em> filter is not currently used in production, but it ties in with the <em>Aids to Navigation</em> module
  of Niord. There, you can start by selecting an AtoN and then execute a message template based on the AtoN
  data.
  The <em>AtoN filter</em> category attribute can be used to filter which templates should be available for
  a given AtoN. For instance, in the example above the "Light Buoy" category and all its sub-categories,
  are only availble to AtoNs matching the filter:
  "aton.kv(<em>'seamark:type</em>', <em>'buoy.*</em>') &amp;&amp; aton.k(<em>'seamark:light.*</em>')".
</p><p class="tableblock">  AtoNs are defined in an
  <a href="http://wiki.openstreetmap.org/wiki/Seamarks/Seamark_Objects">OpenStreetMap (OSM) Seamark</a> format, and thus,
  the filter states that the AtoN should be of type "buoy" and also have an associated light.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optionally, specify the category type. Currently, "Category" and "Template" are the only supported types.
  A Category of the "Category" type has no more attributes. However, a "Template" category has a few
  more attributes detailed in the next section.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-template"><a class="anchor" href="#adding-or-editing-a-template"></a><a class="link" href="#adding-or-editing-a-template">11.2. Adding or Editing a Template</a></h3>
<div class="paragraph">
<p>A category of type "Template" is <em>executable</em>, as described in the
<a href="http://docs.niord.org/editor-manual/manual.html#message-template-execution">Message Template Execution</a>
chapter.</p>
</div>
<div class="paragraph">
<p>This section will detail the attributes that may be edited for templates in addition to the common
attributes editable for all categories and detailed in the previous section.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CategoryEditorPanel.png" alt="Category Editor Page" width="500">
</div>
</div>
<div class="sect3">
<h4 id="domains-attribute"><a class="anchor" href="#domains-attribute"></a><a class="link" href="#domains-attribute">11.2.1. Domains Attribute</a></h4>
<div class="paragraph">
<p>Most of the executable templates only really make sense for Navigational Warnings (NW), not e.g.
Notices to Mariners (NM), since NWs tend to be short and concise and must follow various international
standards. NMs on the other hand, tend to be more <em>free style</em> messages, not easily handled by
a template system.</p>
</div>
<div class="paragraph">
<p>The <em>Domains</em> attribute can thus be used to restrict templates to specific NW-related domains.</p>
</div>
</div>
<div class="sect3">
<h4 id="standard-template-fields-attribute"><a class="anchor" href="#standard-template-fields-attribute"></a><a class="link" href="#standard-template-fields-attribute">11.2.2. Standard Template Fields Attribute</a></h4>
<div class="paragraph">
<p>The <em>Standard Template Fields</em> attributes can be use to specify a list of standard template
editor fields, which mostly constitutes simplified versions of the corresponding message editor
fields - see the <a href="http://docs.niord.org/editor-manual/manual.html#edit-editor-page">Editor Page</a> chapter.
The supported template fields are:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Template Field</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for selecting the NW or NM sub-type of the message.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">promulgation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for enabling and disabling the supported promulgation types.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can be used for selecting the message series of a message.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">publish_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the user to specify a publication date interval.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">areas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to specify the areas and vicinity of the messages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">positions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for defining the positions of the message.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">event_dates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the user to specify a list of event date intervals.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">work_vessel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for specifying work vessels, e.g. for cable operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">markings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used for specifying a list of markings, e.g. used for marking a wreck.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As an example, the "light buoy unlit" message template displays the "type", "promulgation",
"areas" and "positions" standard template fields:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CategoryStdTemplateFields.png" alt="Standard Template Fields" width="800">
</div>
</div>
</div>
<div class="sect3">
<h4 id="template-parameters-attribute"><a class="anchor" href="#template-parameters-attribute"></a><a class="link" href="#template-parameters-attribute">11.2.3. Template Parameters Attribute</a></h4>
<div class="paragraph">
<p>For most message templates, just using <em>standard template fields</em> for user input is not sufficient.
Rather, the user executing the template will need to input template-specific data as well,
such as the buoy function in the "Light buoy unlit" template.</p>
</div>
<div class="paragraph">
<p>The <em>Template Parameters</em> field is used for defining the additional parameters of a template.
The field defines of a list of parameters, using the <em>Parameter Types</em> defined on the
<a href="#parameter-types">Parameter Types</a> sysadmin page.
Indeed, defining the parameters is analogous to the way <em>composite</em> parameter types are defined, as
detailed in the <a href="http://docs.niord.org/sysadmin-manual/manual.html#composite-parameter-type-edit-page">Composite Parameter Type Edit Page</a>.</p>
</div>
<div class="paragraph">
<p>As an example, the "light buoy unlit" message template use the "light_buoy_by_function" <em>composite</em>
parameter type to query the end user about the light buoy function and name:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/CategoryTemplateParams.png" alt="Category Template Parameters" width="800">
</div>
</div>
</div>
<div class="sect3">
<h4 id="script-resources-attribute"><a class="anchor" href="#script-resources-attribute"></a><a class="link" href="#script-resources-attribute">11.2.4. Script Resources Attribute</a></h4>
<div class="paragraph">
<p>The <em>Script Resources</em> attribute is used to define the actual list of script resources, i.e.
server-side JavaScript and Freemarker templates, that get executed, when a message template
is run.</p>
</div>
<div class="paragraph">
<p>The functionality of <em>script resources</em> is detailed in the <a href="#script-resources">Script Resources</a> chapter.
The Freemarker templates are used to generate an <a href="#intermediate-message-template-format">Intermediate Message Template Format</a> that defines
how a message is constructed when a message template is executed.
The JavaScript resources can be used to modify data. In the "Light buoy unlit" example, a
"compute-affected-radius.js" script is run, that will attempt to add an affected radius to the
geometry of the constructed message based on the range to the light (only works if the message template
is run from the AtoN module page).</p>
</div>
<div class="paragraph">
<p>The path specified for a script resource must match an actual script resource defined on the
<a href="#script-resources">Script Resources</a> sysadmin page.
Indeed, clicking the pencil button of the <em>script resource</em> input field will open the specified script
resource for editing on the <a href="#script-resources">Script Resources</a> page.
Clicking the magnifying glass button will open a dialog for easy script resource selection.
Clicking the plus-sign button will add another blank script resource field to the list, and clicking
the trash-icon button will clear the script resource path.
Finally, the order of execution can be controlled by dragging a script resource its proper position using
the <span class="image"><img src="images/DragHandle.png" alt="Drag Handle" width="16"></span> drag handle.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-template-message-attribute"><a class="anchor" href="#example-template-message-attribute"></a><a class="link" href="#example-template-message-attribute">11.2.5. Example Template Message Attribute</a></h4>
<div class="paragraph">
<p>With a large collection of message template, it may not be easy for a non-expert user to guess
which template to execute in a particular situation.</p>
</div>
<div class="paragraph">
<p>The system administrator can define an <em>example template message</em> to each template, to aid the user.
This message will be displayed for guidance, whenever the template is selected in the
<a href="http://docs.niord.org/editor-manual/manual.html#template-selection-dialog">Template Selection Dialog</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reorganizing-categories"><a class="anchor" href="#reorganizing-categories"></a><a class="link" href="#reorganizing-categories">11.3. Reorganizing Categories</a></h3>
<div class="paragraph">
<p>The hierarchical order of the categories are updated in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To move a category to a different parent category, use drag-and-drop.</p>
</li>
<li>
<p>To move a category to another position under the same parent category, use the up- and
down-arrow buttons above the category tree.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="deleting-a-category"><a class="anchor" href="#deleting-a-category"></a><a class="link" href="#deleting-a-category">11.4. Deleting a Category</a></h3>
<div class="paragraph">
<p>A category, including all its sub-categories, can be deleted by selecting it and then click the
"Delete" button above the category tree.
However, this only works if neither the selected category, nor any of its sub-categories, have ever
been assigned to a message.</p>
</div>
<div class="paragraph">
<p>If the category has indeed been assigned to a message, the user should instead deactivate the category.</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-and-exporting-categories"><a class="anchor" href="#importing-and-exporting-categories"></a><a class="link" href="#importing-and-exporting-categories">11.5. Importing and Exporting Categories</a></h3>
<div class="paragraph">
<p>The administrator can export and import categories from the category action menu.</p>
</div>
<div class="paragraph">
<p>The export/import file format is based on a JSON representation of the
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/category/vo/SystemCategoryVo.java">SystemCategoryVo</a>
class.
The data file should define root categories at the top level, and the recursively define sub-categories
in the <em>children</em> field of the parent category.</p>
</div>
<div class="paragraph">
<p>The imported data is merged into the existing category tree. If an MRN is defined for an imported category,
this is used to search for existing categories in the category tree. Alternatively, the name of the category
(in all supported languages)
is used to search for existing matches.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">active</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">descs</span><span class="delimiter">&quot;</span></span>: [
      { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Fyr</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">da</span><span class="delimiter">&quot;</span></span> },
      { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Light</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span> }
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">CATEGORY</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">atonFilter</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">aton.kv('seamark:type', 'light.*')</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">children</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">active</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">descs</span><span class="delimiter">&quot;</span></span>: [
          { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Fyr slukket</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">da</span><span class="delimiter">&quot;</span></span> },
          { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Light unlit</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span> }
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">TEMPLATE</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">siblingSortOrder</span><span class="delimiter">&quot;</span></span>: <span class="float">0.0</span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">domains</span><span class="delimiter">&quot;</span></span>: [
          { <span class="key"><span class="delimiter">&quot;</span><span class="content">domainId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">niord-nw</span><span class="delimiter">&quot;</span></span>, }
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">stdTemplateFields</span><span class="delimiter">&quot;</span></span>: [
          <span class="string"><span class="delimiter">&quot;</span><span class="content">areas</span><span class="delimiter">&quot;</span></span>,
          <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>,
          <span class="string"><span class="delimiter">&quot;</span><span class="content">promulgation</span><span class="delimiter">&quot;</span></span>,
          <span class="string"><span class="delimiter">&quot;</span><span class="content">positions</span><span class="delimiter">&quot;</span></span>
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">templateParams</span><span class="delimiter">&quot;</span></span>: [
          {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">paramId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">aton</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">light</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">mandatory</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">positionList</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">descs</span><span class="delimiter">&quot;</span></span>: [
              { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Fyr</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">da</span><span class="delimiter">&quot;</span></span> },
              { <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Light</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span> }
            ]
          }
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">scriptResourcePaths</span><span class="delimiter">&quot;</span></span>: [
          <span class="string"><span class="delimiter">&quot;</span><span class="content">templates/tmpl/light-unlit.ftl</span><span class="delimiter">&quot;</span></span>,
          <span class="string"><span class="delimiter">&quot;</span><span class="content">templates/tmpl/compute-affected-radius.js</span><span class="delimiter">&quot;</span></span>
        ],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">messageId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NW-003-17</span><span class="delimiter">&quot;</span></span>
      },
      <span class="error">.</span><span class="error">.</span><span class="error">.</span>
    ]
  },
  <span class="error">.</span><span class="error">.</span><span class="error">.</span>
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importing a category JSON file will trigger the <em>category-import</em> batch job.
Batch jobs can be monitored and managed by system administrators.</p>
</div>
<div class="paragraph">
<p>As an alternative to manually uploading a category import JSON file on the <em>Categories</em> admin page,
the file can be copied to the <em>$NIORD_HOME/batch-jobs/category-import/in</em> folder.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="print-reports"><a class="anchor" href="#print-reports"></a><a class="link" href="#print-reports">12. Print Reports</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <em>Print Reports</em> page allows a system administrator to manage the list of PDF print reports in Niord.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PrintReportsPage.png" alt="Print Reports Page" width="800">
</div>
</div>
<div class="paragraph">
<p>The sysadmin may filter the list of print reports by typing a term into the <em>Filter</em> input field above the
print report list. The term is matched against the ID and name of the print reports.</p>
</div>
<div class="paragraph">
<p>Whenever a user selects to print a list of messages, as described in the
<a href="http://docs.niord.org/editor-manual/manual.html#print-messages">Print Action</a> chapter of the editors manual,
she gets to chose which <em>Print Report</em> to use.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PrintDialog.png" alt="Print Dialog" width="180">
</div>
</div>
<div class="paragraph">
<p>The available list of print reports are domain specific, and each print report may query the end user
for a list of input parameters, such as the "Week" and "Year" for the "NM Report" above.
These parameters may in turn be used on the generated PDF, as demonstrated below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PrintReportExample.png" alt="Sample Print Report" width="500">
</div>
</div>
<div class="sect2">
<h3 id="standard-reports"><a class="anchor" href="#standard-reports"></a><a class="link" href="#standard-reports">12.1. Standard Reports</a></h3>
<div class="paragraph">
<p>Niord will always ensure the availability of two standard reports available to all domains.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Standard Report</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Standard</em> report prints out the details of the current message list in the currently
  selected language. It also sports a front page with a <em>Table of Contents</em> section and
  information about the currently applied message filter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Draft</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Draft</em> report is similar to the <em>Standard</em> report, except that it includes all language
  versions of each message, and a few extra fields like message <em>type</em> and <em>status</em> that are not normally
  included. This makes the <em>Draft</em> report very usable for proof-reading messages.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="generating-pdfs"><a class="anchor" href="#generating-pdfs"></a><a class="link" href="#generating-pdfs">12.2. Generating PDFs</a></h3>
<div class="paragraph">
<p>Generating PDFs using print reports is actually a two-phase process. First, the Freemarker template
associated with the print report is used to convert a list of message into a HTML representation.
Then, the HTML is converted into a PDF and returned to the user.</p>
</div>
<div class="paragraph">
<p>When creating and editing print reports, is important to understand how <em>CSS Paged Media</em> can be
used to control such things as page size, pagination, headers and footers in the resulting PDF.
Thus, the sysadmin is advised to acquaint herself with relevant documentation, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.w3.org/TR/css3-page/" class="bare">https://www.w3.org/TR/css3-page/</a> - CSS Paged Media specification.</p>
</li>
<li>
<p><a href="https://www.smashingmagazine.com/2015/01/designing-for-print-with-css/" class="bare">https://www.smashingmagazine.com/2015/01/designing-for-print-with-css/</a> - Introduction to using paged media.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adding-or-editing-a-print-report"><a class="anchor" href="#adding-or-editing-a-print-report"></a><a class="link" href="#adding-or-editing-a-print-report">12.3. Adding or Editing a Print Report</a></h3>
<div class="paragraph">
<p>The sysadmin can add a new print report by clicking the "New Report" button, or edit an existing
print report by clicking the pencil symbol next to the domain.</p>
</div>
<div class="paragraph">
<p>This will open the <em>Print Report Edit Page</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/PrintReportEditPage.png" alt="Print Report Editor Page" width="500">
</div>
</div>
<div class="paragraph">
<p>The print report attributes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Report Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Report ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique ID for the report.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A human readable name of the report.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort Order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the order of the print reports as used in the Print Dialog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Freemarker template used to generate HTML. The specified path must be the path of an existing
  script resource, as defined in the <a href="#script-resources">Script Resources</a> chapter.
  Clicking the pencil button next to the path input field will indeed open the report on the
  <a href="#script-resources">Script Resources</a> sysadmin page. Clicking the magnifying glass icon will open a dialog for
  easy script resource selection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domains</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The domains for which the print report will be made available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read-only Properties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A JSON property object that may be used in the Freemarker template. In the "NM Report" example
  screenshots above, the "volume" value, "133", and "ISSN" value, "1397-999X", come from these
  read-only properties.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Parameters</em> field is exactly like the <em>Read-only Properties</em>, except that the properties will
  be displayed in the Print dialog, and may thus be edited by the user per print.
  The <em>Parameter</em> values may be instantiated with default values containing <em>replacement tokens</em>, such
  as "${year-2-digits}", "${year}", "${week-2-digits}" and "${week}".
  In the "NM Report" example screenshots above, the effect of specifying "week" and "year" parameters
  can be seen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>Test</em> field is not actually a print report attribute. The sysadmin can specify a message tag
  and test-execute the print report in this section.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="deleting-a-print-report"><a class="anchor" href="#deleting-a-print-report"></a><a class="link" href="#deleting-a-print-report">12.4. Deleting a Print Report</a></h3>
<div class="paragraph">
<p>A print report can be deleted by clicking the trash icon next to them.</p>
</div>
</div>
<div class="sect2">
<h3 id="importing-and-exporting-print-reports"><a class="anchor" href="#importing-and-exporting-print-reports"></a><a class="link" href="#importing-and-exporting-print-reports">12.5. Importing and Exporting Print Reports</a></h3>
<div class="paragraph">
<p>The system administrator can export and import print reports from the action menu.</p>
</div>
<div class="paragraph">
<p>The export/import file format is based on a JSON representation of the
<a href="https://github.com/NiordOrg/niord/blob/master/niord-core/src/main/java/org/niord/core/report/vo/FmReportVo.java">FmReportVo</a>
class.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">reportId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">nm-report</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NM report</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">sortOrder</span><span class="delimiter">&quot;</span></span>: <span class="integer">2</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">templatePath</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">templates/messages/nm-report-pdf.ftl</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">domains</span><span class="delimiter">&quot;</span></span>: [
      { <span class="key"><span class="delimiter">&quot;</span><span class="content">domainId</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">niord-nm</span><span class="delimiter">&quot;</span></span> }
    ],
    <span class="key"><span class="delimiter">&quot;</span><span class="content">properties</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">mapThumbnails</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">ISSN</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1397-999X</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">volume</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">133</span><span class="delimiter">&quot;</span></span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">params</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">week</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${week}</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${year}</span><span class="delimiter">&quot;</span></span>
    }
  },
  <span class="error">.</span><span class="error">.</span><span class="error">.</span>
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importing a print report JSON file will trigger the <em>report-import</em> batch job.
Batch jobs can be monitored and managed by system administrators.</p>
</div>
<div class="paragraph">
<p>As an alternative to manually uploading a report import JSON file on the <em>Print Reports</em> sysadmin page,
the file can be copied to the <em>$NIORD_HOME/batch-jobs/report-import/in</em> folder.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="keycloak-integration"><a class="anchor" href="#keycloak-integration"></a><a class="link" href="#keycloak-integration">13. Keycloak Integration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Keycloak is an open source identity and access management middleware product, which is documented
in detail at the <a href="http://www.keycloak.org">Keycloak website</a>.</p>
</div>
<div class="paragraph">
<p>In general, once Niord has been set up and configured, there is hardly any need for administrators
to use Keycloak directly.</p>
</div>
<div class="paragraph">
<p>Keycloak has been integrated tightly with Niord in the manner detailed below. The reader should be
somewhat familiar with Keycloak before reading this.</p>
</div>
<div class="sect2">
<h3 id="niord-domains"><a class="anchor" href="#niord-domains"></a><a class="link" href="#niord-domains">13.1. Niord Domains</a></h3>
<div class="paragraph">
<p>Domains in Niord are detailed in the <a href="#domains">Domains</a> chapter.
For each domain in Niord, there will be <em>bearer only</em> application client in Keycloak.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/KeycloakClients.png" alt="Keycloak Clients" width="600">
</div>
</div>
<div class="paragraph">
<p>As an example, for the "NM" Niord domain, there is a corresponding "niord-nm" application client
in Keycloak.</p>
</div>
<div class="paragraph">
<p>Also, there is a single <em>public</em> application client for the actual Niord web application.</p>
</div>
<div class="sect3">
<h4 id="roles"><a class="anchor" href="#roles"></a><a class="link" href="#roles">13.1.1. Roles</a></h4>
<div class="paragraph">
<p>As described in the <a href="#system-administrators-manual">System Administrators Manual</a> chapter, a user may have either the <em>User</em>,
<em>Editor</em>, <em>Admin</em> or <em>Sysadmin</em> role in each of the Niord domains.</p>
</div>
<div class="paragraph">
<p>These roles area really just <em>application client roles</em> in Keycloak:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/KeycloakClientRoles.png" alt="Keycloak Client Roles" width="600">
</div>
</div>
<div class="paragraph">
<p>The roles are <em>composite</em> client roles, defined hierarchically, so that if a user has the <em>Sysadmin</em>
role, she also automatically has the <em>Admin</em> role, if she has the <em>Admin</em> roles, she also automatically
has the <em>Editor</em> role, and if she has the <em>Editor</em> role, she also automatically has the <em>User</em> role.</p>
</div>
<div class="paragraph">
<p>When a domain is created via the Niord UI, the corresponding application client, including the client
roles mentioned above, are created automatically in Keycloak.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="niord-users"><a class="anchor" href="#niord-users"></a><a class="link" href="#niord-users">13.2. Niord Users</a></h3>
<div class="paragraph">
<p>All users in Niord are created and maintained in Keycloak, although Niord also provides a UI for
managing users on top of Keycloak, as detailed in the
<a href="http://docs.niord.org/admin-manual/manual.html#users-contacts">Users &amp; Contacts</a> chapter of the
administrator guide.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/KeycloakUsers.png" alt="Keycloak Users" width="600">
</div>
</div>
<div class="paragraph">
<p>In turn, Keycloak may be configured to use other identity providers.
For instance, in the set-up used by the Danish Maritime Authority (DMA), Keycloak is integrated with the
<em>DMA Active Directory Federation Service</em>, and hence, the first time a DMA employee clicks the "DMA" link
on the log-in page and logs in using her usual work credentials, she will automatically be created as
a user in Keycloak.</p>
</div>
<div class="paragraph">
<p>Keycloak can also be integrated with other Keycloak services, Active Directory or other LDAP provides, etc.</p>
</div>
<div class="sect3">
<h4 id="user-groups"><a class="anchor" href="#user-groups"></a><a class="link" href="#user-groups">13.2.1. User Groups</a></h4>
<div class="paragraph">
<p>Instead of assigning domain roles (i.e. Keycloak application client roles) directly to users, which would
be a tedious task, Niord instead rely on Keycloak <em>Groups</em>.</p>
</div>
<div class="paragraph">
<p>As an example, at the Danish Maritime Authority, the following user groups are defined,
at the time of writing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Sysadmin</em>: Members of the "Sysadmin" user group will have the <em>Sysadmin</em> role in all domains.</p>
</li>
<li>
<p><em>Admins</em>: Members of the "Admins" user group will have the <em>Admin</em> role in all domains.</p>
</li>
<li>
<p><em>Editors</em>: Members of the "Editor" user group will have the <em>Editor</em> role in the "NW", "NM", "Firing Areas",
"NM Almanac", "NM Annex" and "NW Greenland" domains.</p>
</li>
<li>
<p><em>Case Officers</em>: Members of the "Case Officers" user group will have the <em>User</em> role the "NW", "NM", "Firing Areas",
"NM Almanac", "NM Annex" and "NW Greenland" domains.</p>
</li>
<li>
<p><em>FE Editors</em>: Members of the "FE Editors" user group will have the <em>Editor</em> role in the "Firing Areas" domain.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These groups are defined and maintained in Keycloak:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/KeycloakGroups.png" alt="Keycloak Groups" width="600">
</div>
</div>
<div class="paragraph">
<p>For each group, the relevant domain roles are assigned, as in the example below, where the
"Editors" group is assigned the "editor" role of the "niord-nm" application client (i.e. "NM" domain):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/KeycloakGroupRoles.png" alt="Keycloak Group Roles" width="600">
</div>
</div>
<div class="paragraph">
<p>Groups are created and maintained quite rarely. However, assigning users to groups is a common
everyday task for administrators.
Hence, Niord provides a simplified UI for this task, as detailed in the
<a href="http://docs.niord.org/admin-manual/manual.html#managing-user-group-membership">Managing User Group Memebership</a>
chapter.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="user-specific-editor-fields"><a class="anchor" href="#user-specific-editor-fields"></a><a class="link" href="#user-specific-editor-fields">13.3. User-Specific Editor-Fields</a></h3>
<div class="paragraph">
<p>The list of editor fields being displayed when a user edits a message in Niord is highly configurable.
There are settings to define a base set of fields, a message main-type (NW,NM) specific set,
plus the list can be customized depending on the message series, areas and categories assigned
to the message.</p>
</div>
<div class="paragraph">
<p>It is also possible to customize the list of editor fields per user in Keycloak, or indeed, per user
group.</p>
</div>
<div class="paragraph">
<p>Step 1 is for the system administrator to define two <em>User Attribute Mappers</em> for the "niord-web"
application client; one for the "editorFieldsNw" <em>token claim</em> and one for the "editorFieldsNm"
<em>token claim</em>. Example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/KeycloakClientMapper.png" alt="Keycloak Client Mapper" width="600">
</div>
</div>
<div class="paragraph">
<p>Step 2 is for the system administrator to assign the relevant "editorFieldsNw" and "editorFieldsNm"
user attributes either directly to the user, or - more likely - to the relevant user groups.
The format of the attribute values should be a JSON structure that enables and disables specific
editor fields. Example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/KeycloakGroupAttribute.png" alt="Keycloak Group Attribute" width="600">
</div>
</div>
</div>
<div class="sect2">
<h3 id="niord-security"><a class="anchor" href="#niord-security"></a><a class="link" href="#niord-security">13.4. Niord Security</a></h3>
<div class="paragraph">
<p>All access to the Niord backend happens via calls to REST endpoints. The obvious example is the
actual Niord web application which makes Ajax calls to the Niord backend.</p>
</div>
<div class="paragraph">
<p>The Niord backend has been integrated with Keycloak, so that all calls to Niord resolves the
roles of the callee in the context of the current domain
(the current domain is specified via a request header).</p>
</div>
<div class="paragraph">
<p>Hence, access to Niord can be checked using standard Java EE security checks.
See the (simplified) example below, where annotating a REST endpoint with "@RolesAllowed(Roles.ADMIN)"
will validate that the user has the <em>Admin</em> role in the current domain, or throw an exception.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PUT</span>
<span class="annotation">@Path</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/area/{areaId}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Consumes</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json;charset=UTF-8</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Produces</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/json;charset=UTF-8</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RolesAllowed</span>(Roles.ADMIN)
<span class="directive">public</span> SystemAreaVo updateArea(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">areaId</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Integer</span> areaId, SystemAreaVo areaVo) {
    <span class="predefined-type">Area</span> area = <span class="keyword">new</span> <span class="predefined-type">Area</span>(areaVo);
    <span class="keyword">return</span> areaService.updateAreaData(area).toVo(SystemAreaVo.class, DataFilter.get());
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-06-26 08:09:44 CEST
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>